{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\nimport firebase from \"firebase\";\nimport { CURRENT_USER_PETS, USER_STATE_CHANGE, OTHER_USER_PETS } from \"../constants\";\nimport { saveMediaToStorage } from \"../../services/random\";\n\nrequire('firebase/firestore');\n\nexport var showUserPets = function showUserPets() {\n  var _firebase$auth$curren;\n\n  var uid = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : (_firebase$auth$curren = firebase.auth().currentUser) == null ? void 0 : _firebase$auth$curren.uid;\n  return function (dispatch) {\n    firebase.firestore().collection('user').doc(uid).collection('Mascotas').onSnapshot(function (snapshot) {\n      var _firebase$auth$curren2;\n\n      var pets = snapshot.docs.map(function (doc) {\n        var data = doc.data();\n        var id = doc.id;\n        return _objectSpread({\n          id: id\n        }, data);\n      });\n\n      if (uid == ((_firebase$auth$curren2 = firebase.auth().currentUser) == null ? void 0 : _firebase$auth$curren2.uid)) {\n        dispatch({\n          type: CURRENT_USER_PETS,\n          currentUserPets: pets,\n          otherUserPets: pets\n        });\n      } else {\n        dispatch({\n          type: OTHER_USER_PETS,\n          otherUserPets: pets\n        });\n      }\n    });\n  };\n};\nexport var PetStateChange = function PetStateChange(petid, estado) {\n  return function (dispatch) {\n    return new Promise(function (resolve, reject) {\n      var _firebase$auth$curren3;\n\n      firebase.firestore().collection('user').doc((_firebase$auth$curren3 = firebase.auth().currentUser) == null ? void 0 : _firebase$auth$curren3.uid).collection('Mascotas').doc(petid).update({\n        'Estado': !estado\n      }).then(function () {\n        resolve();\n      }).catch(function () {\n        reject();\n      });\n    });\n  };\n};\nexport var PetPostChange = function PetPostChange(petid, estado) {\n  return function (dispatch) {\n    return new Promise(function (resolve, reject) {\n      firebase.firestore().collection('user').doc(firebase.auth().currentUser.uid).collection('Mascotas').doc(petid).update({\n        'estado': !estado\n      }).then(function () {\n        resolve();\n      }).catch(function () {\n        reject();\n      });\n    });\n  };\n};\nexport var createUserPet = function createUserPet(Nombre, Raza, Edad) {\n  var uid,\n      response,\n      _args = arguments;\n  return _regeneratorRuntime.async(function createUserPet$(_context) {\n    while (1) {\n      switch (_context.prev = _context.next) {\n        case 0:\n          uid = _args.length > 3 && _args[3] !== undefined ? _args[3] : firebase.auth().currentUser.uid;\n          _context.next = 3;\n          return _regeneratorRuntime.awrap(firebase.firestore().collection('user').doc(uid).collection('Mascotas').add({\n            idOwner: uid,\n            Nombre: Nombre,\n            Estado: false,\n            Edad: Edad,\n            Raza: Raza\n          }));\n\n        case 3:\n          response = _context.sent;\n          return _context.abrupt(\"return\", response);\n\n        case 5:\n        case \"end\":\n          return _context.stop();\n      }\n    }\n  }, null, null, null, Promise);\n};\nexport function signOut() {\n  var _this = this;\n\n  return _regeneratorRuntime.async(function signOut$(_context2) {\n    while (1) {\n      switch (_context2.prev = _context2.next) {\n        case 0:\n          firebase.auth().signOut().then(function () {\n            _this.setState({\n              user: null\n            });\n\n            _this.props.history.push(\"/\");\n          }).catch(function (error) {});\n\n        case 1:\n        case \"end\":\n          return _context2.stop();\n      }\n    }\n  }, null, null, null, Promise);\n}\nexport function addSolicitud(uid, idMascota, nombre, mensaje) {\n  return _regeneratorRuntime.async(function addSolicitud$(_context3) {\n    while (1) {\n      switch (_context3.prev = _context3.next) {\n        case 0:\n          firebase.firestore().collection('user').doc(uid).collection('Mascotas').doc(idMascota).collection('Solicitud').add({\n            idPropuesta: firebase.auth().currentUser.uid,\n            nombre: nombre,\n            mensaje: mensaje\n          });\n\n        case 1:\n        case \"end\":\n          return _context3.stop();\n      }\n    }\n  }, null, null, null, Promise);\n}","map":{"version":3,"names":["firebase","CURRENT_USER_PETS","USER_STATE_CHANGE","OTHER_USER_PETS","saveMediaToStorage","require","showUserPets","uid","auth","currentUser","dispatch","firestore","collection","doc","onSnapshot","snapshot","pets","docs","map","data","id","type","currentUserPets","otherUserPets","PetStateChange","petid","estado","Promise","resolve","reject","update","then","catch","PetPostChange","createUserPet","Nombre","Raza","Edad","add","idOwner","Estado","response","signOut","setState","user","props","history","push","error","addSolicitud","idMascota","nombre","mensaje","idPropuesta"],"sources":["D:/2022-1/GEST.PROYECTOS/pocket-pet/frontend/src/redux/actions/pet.js"],"sourcesContent":["import firebase from \"firebase\";\r\nimport { CURRENT_USER_PETS, USER_STATE_CHANGE,OTHER_USER_PETS } from \"../constants\";\r\nimport { saveMediaToStorage } from '../../services/random';\r\nrequire('firebase/firestore')\r\n\r\nexport const showUserPets = (uid=firebase.auth().currentUser?.uid) => (dispatch) => {\r\n    firebase.firestore()\r\n    .collection('user')\r\n    .doc(uid)\r\n    .collection('Mascotas')\r\n    .onSnapshot((snapshot)=>{\r\n        let pets = snapshot.docs.map(doc=>{\r\n            const data= doc.data()\r\n            const id= doc.id    \r\n            return{id, ...data}\r\n        })\r\n\r\n        if (uid==firebase.auth().currentUser?.uid) { //Si es el perfil del usuario\r\n          dispatch({type: CURRENT_USER_PETS, currentUserPets: pets, otherUserPets:pets})\r\n        }\r\n        else {\r\n          dispatch({type: OTHER_USER_PETS, otherUserPets:pets})\r\n        }\r\n    })\r\n}\r\n\r\n\r\nexport const PetStateChange = (petid, estado) => (dispatch) =>\r\n  new Promise((resolve, reject) => {\r\n    firebase\r\n    .firestore()\r\n    .collection('user')\r\n    .doc(firebase.auth().currentUser?.uid)\r\n    .collection('Mascotas')\r\n    .doc(petid)\r\n    .update({\r\n        'Estado' : !estado ,\r\n    })\r\n    .then(() => {\r\n        resolve();\r\n      })\r\n      .catch(() => {\r\n          \r\n        reject();\r\n      });\r\n  });\r\n\r\n\r\n  \r\nexport const PetPostChange = (petid, estado) => (dispatch) =>\r\nnew Promise((resolve, reject) => {\r\n  firebase\r\n  .firestore()\r\n  .collection('user')\r\n  .doc(firebase.auth().currentUser.uid)\r\n  .collection('Mascotas')\r\n  .doc(petid)\r\n  .update({\r\n      'estado' : !estado ,\r\n  })\r\n  .then(() => {\r\n      resolve();\r\n    })\r\n    .catch(() => {\r\n        \r\n      reject();\r\n    });\r\n});\r\n\r\nexport const createUserPet = async(Nombre,Raza,Edad,uid=firebase.auth().currentUser.uid) => \r\n{const response = await firebase.firestore()\r\n  .collection('user')\r\n  .doc(uid)\r\n  .collection('Mascotas')\r\n  .add({\r\n    idOwner: uid,\r\n    Nombre,\r\n    Estado: false,\r\n    Edad,\r\n    Raza\r\n  })\r\n  return response\r\n}\r\n\r\nexport async function signOut() {\r\n  firebase.auth().signOut().then(() =>{\r\n    this.setState({\r\n     user:null\r\n    })\r\n    this.props.history.push(\"/\");\r\n    }).catch(function(error) {\r\n    // An error happened.\r\n    });\r\n }\r\n\r\nexport async function addSolicitud(uid, idMascota, nombre, mensaje){\r\n  firebase\r\n  .firestore()\r\n  .collection('user')\r\n  .doc(uid)\r\n  .collection('Mascotas')\r\n  .doc(idMascota)\r\n  .collection('Solicitud')\r\n  .add({\r\n    idPropuesta: firebase.auth().currentUser.uid,\r\n    nombre,\r\n    mensaje\r\n  })\r\n}\r\n\r\n/*export const editTipo = async(uid=firebase.auth().currentUser.uid) => \r\n{const response = await firebase.firestore()\r\n  .collection('user')\r\n  .doc(uid)\r\n  .add({\r\n    TipoUsuario: 'Albergue',\r\n  })\r\n  return response\r\n}*/\r\n\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}